!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"memory",(function(){return c})),n.d(r,"pages",(function(){return d})),n.d(r,"loadMemory",(function(){return h})),n.d(r,"reset",(function(){return a})),n.d(r,"forEach",(function(){return f})),n.d(r,"getIndexForXY",(function(){return l})),n.d(r,"getXYForIndex",(function(){return y})),n.d(r,"toString",(function(){return p})),n.d(r,"write",(function(){return g})),n.d(r,"test",(function(){return x})),n.d(r,"peek",(function(){return w})),n.d(r,"isFree",(function(){return b}));const o=100,i=50,s=50,u=("undefined"!=typeof window?window.innerHeight:100)/s*.6|0,c=new Uint8Array(i*s),d=[Uint8Array.from(c)],h=t=>{a();const e=t.split("\n");let n=c.length-1;for(let t=e.length-1;t>=0;t--)for(let r=e[t].length-1;r>=0;r--){const o=e[t][r];c[n]="0"!==o?o.charCodeAt(0):0,n--}d.push(Uint8Array.from(c))},a=()=>{d.length=0,c.fill(0)},f=t=>c.forEach(t),l=(t,e,n=i)=>{if(t<0)throw new Error(`out of bounds: x(${t}) < 0`);if(t>=i)throw new Error(`out of bounds: x(${t}) > WIDTH(${i})`);if(e<0)throw new Error(`out of bounds: y(${e}) < 0`);if(e>=s)throw new Error(`out of bounds: y(${e}) > HEIGHT(${s})`);return n*e+t},y=t=>{return{x:t%i,y:t/i|0}},p=(t=c)=>t.reduce((t,e,n)=>{const{y:r}=y(n);return t[r]||(t[r]=""),t[r]+=e?String.fromCharCode(1===e?88:e):" ",t},[]).join("\n"),g=(t,e=1)=>{const{x:n,y:r}=t;let o=l(n,r);c[o]=e,d.push(Uint8Array.from(c))},x=t=>{const{x:e,y:n}=t;let r=!1,o=l(e,n);return c[o]&&(r=!0),{hit:r}},w=({x:t,y:e})=>{try{return c[l(t,e)]}catch(t){return-1}},b=t=>{try{return!x(t).hit}catch(t){return!1}};class m{constructor(){this.head={x:i/2|0,y:s/2|0},this.id=1,this.x=1,this.y=0,this.tail={x:i/2|0,y:s/2|0},this.points=[this.head],this.handlers={},this.update()}on(t,e){this.handlers[t]||(this.handlers[t]=[]),this.handlers[t].push(e)}emit(t){this.handlers[t]&&this.handlers[t].forEach(t=>setTimeout(t,0))}get size(){return this.points.length}get score(){return this.points.length-1}grow(){this.points.push(this.head),this.emit("grow")}update({x:t=this.head.x,y:e=this.head.y}={}){const n=this.points.shift();g(n,0);const r=w({x:t,y:e});if(255===r)this.grow();else if(r||-1===r)return void this.emit("over");g({x:t,y:e}),this.head={x:t,y:e},this.points.push(this.head)}forward(){this.update({x:this.head.x+this.x,y:this.head.y+this.y})}left(){0===this.y?(1===this.x?this.y=-1:this.y=1,this.x=0):(1===this.y?this.x=1:this.x=-1,this.y=0)}right(){0===this.y?(1===this.x?this.y=1:this.y=-1,this.x=0):(1===this.y?this.x=-1:this.x=1,this.y=0)}}const v={};window.addEventListener("gamepadconnected",(function(t){const{gamepad:e}=t;v[e.index]=e})),window.addEventListener("gamepaddisconnected",(function(t){const{gamepad:e}=t;delete v[e.index]}));const E=-1,S=1,A={},k={};const M={a:E,b:E,left:E,right:E,down:E};function j(t,e){if(!e)return M[t]=E,void(A[t]&&delete A[t]);A[t]?M[t]=E:M[t]!==E?M[t]++:M[t]=S}function O(t){const e="keydown"===t.type;let n=null;"Space"!==t.code&&"KeyA"!==t.code&&"KeyB"!==t.code||(n="KeyB"===t.code?"b":"a"),"ArrowLeft"===t.code&&(n="left"),"ArrowDown"===t.code&&(n="down"),"ArrowUp"===t.code&&(n="up"),"ArrowRight"===t.code&&(n="right"),n&&(k[n]=e)}function T(){const t=function(){const t=[],e=Array.from(navigator.getGamepads()).filter(Boolean);for(let n in e){const r=e[n],o={axes:{left:!1,right:!1,up:!1,down:!1},buttons:{a:!1,b:!1}};t.push(o);for(let t=0;t<r.buttons.length;t++){let e=r.buttons[t],n=1==e;"object"==typeof e&&(n=e.pressed,e=e.value);const i=Math.round(100*e);o.buttons[t]={value:e,pressed:n,pcent:i},0===t&&(o.buttons.a=n),1===t&&(o.buttons.b=n)}for(let t=0;t<r.axes.length;t++){const e=r.axes[t].toFixed(2);e<-.5&&(o.axes[0===t?"left":"up"]=!0),e>.5&&(o.axes[0===t?"right":"down"]=!0)}}return t}()[0];t?function(t){for(let e of["left","right","down","up"])j(e,t.axes[e]);for(let e of["a","b"])j(e,t.buttons[e])}(t):function(){for(let t of["left","right","down","up","a","b"])j(t,k[t])}()}window.addEventListener("keydown",O,!1),window.addEventListener("keyup",O,!1);const L=document.querySelector("#score"),P={running:!0,ticks:{last:null},direction:"right"};function H(){a(),P.running=!0,P.canvas.width=i*u,P.canvas.height=s*u,P.ctx.fillStyle="black",P.ctx.fillRect(0,0,i*u,s*u),P.ctx.fillStyle="white",P.speed=o,P.user=new m,P.user.on("grow",F),P.user.on("grow",_),P.user.on("over",$),setTimeout(F,500),U()}function $(){P.running=!1,L.innerHTML="GAME OVER "+P.user.score}function _(){P.speed-=32,P.speed<16&&(P.speed=16)}function F(){const t=c,e=t.length;let n=Math.random()*e|0;for(;n<t&&0!==t[n];n++);const{x:r,y:o}=y(n);g({x:r,y:o},255)}function U(t){if(T(),["left","right"].forEach(t=>{(function(t,e=M){return e[t]>E})(t)&&(P.user[t](),function(t){A[t]=!0,M[t]=E}(t))}),P.running){const{user:e}=P;t-P.ticks.last>P.speed&&(P.ticks.last=t,e.forward(),function(){L.innerHTML=P.user.score;const{ctx:t}=P;t.fillStyle="black",t.fillRect(0,0,i*u,s*u),t.fillStyle="white";const e=[];t.beginPath(),f((n,r)=>{if(!n)return;const{x:o,y:i}=y(r);255!==n?t.rect(o*u,i*u,u,u):e.push({x:o,y:i})}),t.fill(),t.beginPath(),t.fillStyle="green",e.forEach(({x:e,y:n})=>{t.rect(e*u,n*u,u,u)}),t.fill()}())}requestAnimationFrame(U)}window.game=P,window.memory=r,P.canvas=document.querySelector("canvas"),P.ctx=P.canvas.getContext("2d"),P.canvas.onclick=()=>{P.running||H()},H()}]);